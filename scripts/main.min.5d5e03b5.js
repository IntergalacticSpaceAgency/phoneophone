(function(){var a,b;a=function(){function a(a){this.min_frequency=_.min(a),this.max_frequency=_.max(a)}return a.prototype.get_active_frequency=function(a){return this.min_frequency+a*(this.max_frequency-this.min_frequency)},a}(),b=function(){function a(a,b,c){null==b&&(b=[]),null==c&&(c=7),this.frequencies=this._skip_frequencies(_.sortBy(a),b,c),this.min_frequency=_.first(this.frequencies),this.max_frequency=_.last(this.frequencies)}return a.prototype.get_active_frequency=function(a){var b;return b=this.min_frequency+a*(this.max_frequency-this.min_frequency),_.chain(this.frequencies).reject(function(a){return a>b}).last().value()},a.prototype._skip_frequencies=function(a,b,c){return _.reject(a,function(a){return function(a,d){return _.includes(b,d%c)}}(this))},a}(),window.PhoneoPhone=window.PhoneoPhone||{},PhoneoPhone.ContinuousScale=a,PhoneoPhone.DiscreteScale=b}).call(this),function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};b=function(){function a(a,b,d,e){this.audio_context=a,this.type=b,this.frequency=d,this.gain_value=e,this._create_gain_for_oscillator=c(this._create_gain_for_oscillator,this),this._create_oscillator=c(this._create_oscillator,this),this.stop=c(this.stop,this),this.start=c(this.start,this),this.update=c(this.update,this),this.oscillator=this._create_oscillator(this.type,this.frequency),this.gain=this._create_gain_for_oscillator(this.oscillator,this.gain_value)}return a.prototype.update=function(a,b){return this.frequency=a,this.gain_value=b,this.oscillator.frequency.value=a,this.gain.gain.value=b},a.prototype.start=function(a){return null==a&&(a=0),this.oscillator.start(a)},a.prototype.stop=function(a){return null==a&&(a=0),this.oscillator.stop(a)},a.prototype._create_oscillator=function(a,b){var c;return c=this.audio_context.createOscillator(),c.type=a,c.frequency.value=b,c},a.prototype._create_gain_for_oscillator=function(a,b){var c;return c=this.audio_context.createGain(),c.gain.value=b,c.connect(this.audio_context.destination),a.connect(c),c},a}(),a=function(){function a(a,d,e,f){this.audio_context=a,this.frequency=d,this.crossfade=null!=e?e:.5,this.gain_value_scaling_factor=null!=f?f:.1,this._gain_value=c(this._gain_value,this),this.stop=c(this.stop,this),this.start=c(this.start,this),this.update=c(this.update,this),this.left=new b(this.audio_context,"sine",this.frequency,this._gain_value(1-this.crossfade)),this.right=new b(this.audio_context,"sawtooth",this.frequency,this._gain_value(this.crossfade))}return a.prototype.update=function(a,b){return this.frequency=a,this.crossfade=b,this.left.update(this.frequency,this._gain_value(1-b)),this.right.update(this.frequency,this._gain_value(b))},a.prototype.start=function(a){return null==a&&(a=0),_.each([this.left,this.right],function(b){return b.start(a)})},a.prototype.stop=function(a){return null==a&&(a=0),_.each([this.left,this.right],function(b){return b.stop(a)})},a.prototype._gain_value=function(a){return a*this.gain_value_scaling_factor},a}(),window.PhoneoPhone=window.PhoneoPhone||{},PhoneoPhone.Tone=b,PhoneoPhone.DualTone=a}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c){var d;this.el=a,this.crossfade_at_x=b(this.crossfade_at_x,this),this.frequency_at_y=b(this.frequency_at_y,this),this.stop_tone=b(this.stop_tone,this),this.start_tone=b(this.start_tone,this),this.on_stop_event=b(this.on_stop_event,this),this.on_change_event=b(this.on_change_event,this),this.on_start_event=b(this.on_start_event,this),this.add_deviceorientation_control=b(this.add_deviceorientation_control,this),this.add_touch_control=b(this.add_touch_control,this),this.add_mouse_control=b(this.add_mouse_control,this),this.delete_dual_tone=b(this.delete_dual_tone,this),this.update_dual_tone=b(this.update_dual_tone,this),this.add_dual_tone=b(this.add_dual_tone,this),d=window.AudioContext||window.webkitAudioContext,this.scales=[new PhoneoPhone.ContinuousScale(c),new PhoneoPhone.DiscreteScale(c),new PhoneoPhone.DiscreteScale(c,[2,6])],this.scale=this.scales[0],this.dual_tones={},_.isUndefined(d)?this.el.innerHTML='<div id="audio-context-unsupported">Oh no! PhoneoPhone requires the Web Audio API, which your browser does not support. In the future, we hope to add support for browsers like yours. For now, to use PhoneoPhone, please upgrade your web browser to the latest version. If the latest version of your browser does not support the Web Audio API, please try a different web browser. Thank you!</div>':(this.audio_context=new d,this.add_controls())}return a.prototype.add_dual_tone=function(a,b,c){return this.dual_tones[a]=new PhoneoPhone.DualTone(this.audio_context,b,c)},a.prototype.update_dual_tone=function(a,b,c){return _.isObject(this.dual_tones[a])?this.dual_tones[a].update(b,c):void 0},a.prototype.delete_dual_tone=function(a){return _.isObject(this.dual_tones[a])?delete this.dual_tones[a]:void 0},a.prototype.add_controls=function(){return this.add_mouse_control(),this.add_touch_control(),this.add_deviceorientation_control()},a.prototype.add_mouse_control=function(a,b,c,d){return a="mouse",this.el.addEventListener("mousedown",function(b){return function(c){return c.preventDefault(),b.on_start_event(c,a)}}(this)),this.el.addEventListener("mousemove",function(b){return function(c){return c.preventDefault(),b.on_change_event(c,a)}}(this)),_.each(["mouseup","mouseout","mouseleave"],function(b){return function(c){return b.el.addEventListener(c,function(c){return c.preventDefault(),b.on_stop_event(c,a)})}}(this))},a.prototype.add_touch_control=function(){return this.el.addEventListener("touchstart",function(a){return function(b){return b.preventDefault(),_.each(b.changedTouches,function(b){return a.on_start_event(b,b.identifier)})}}(this)),this.el.addEventListener("touchmove",function(a){return function(b){return b.preventDefault(),_.each(b.changedTouches,function(b){return a.on_change_event(b,b.identifier)})}}(this)),this.el.addEventListener("touchend",function(a){return function(b){return b.preventDefault(),_.each(b.changedTouches,function(b){return a.on_stop_event(b,b.identifier)})}}(this)),this.el.addEventListener("touchcancel",function(a){return function(b){return b.preventDefault(),_.each(b.changedTouches,function(b){return a.on_stop_event(b,b.identifier)})}}(this))},a.prototype.add_deviceorientation_control=function(){return window.addEventListener("deviceorientation",function(a){return function(b){var c,d;return c=Math.abs(90-Math.abs(b.beta)),d=30>=c?2:60>=c?1:0,a.scale=a.scales[d]}}(this))},a.prototype.on_start_event=function(a,b){var c,d;return d=this.frequency_at_y(a.clientY),c=this.crossfade_at_x(a.clientX),this.add_dual_tone(b,d,c),this.start_tone(b)},a.prototype.on_change_event=function(a,b){var c,d;return d=this.frequency_at_y(a.clientY),c=this.crossfade_at_x(a.clientX),this.update_dual_tone(b,d,c)},a.prototype.on_stop_event=function(a,b){return this.stop_tone(b),this.delete_dual_tone(b)},a.prototype.start_tone=function(a){return _.isObject(this.dual_tones[a])?this.dual_tones[a].start():void 0},a.prototype.stop_tone=function(a){return _.isObject(this.dual_tones[a])?this.dual_tones[a].stop():void 0},a.prototype.frequency_at_y=function(a){return this.scale.get_active_frequency(a/this.el.clientHeight)},a.prototype.crossfade_at_x=function(a){return a/this.el.clientWidth},a}(),window.PhoneoPhone=window.PhoneoPhone||{},PhoneoPhone.AudioSpace=a}.call(this),function(){var a,b,c;c=[1760,1567.98,1396.91,1318.51,1174.66,1046.5,987.77,880,783.99,698.46,659.26,587.33,523.25,493.88,440,392,349.23,329.63,293.66,261.63,246.94,220,196,174.61,164.81,146.83,130.81,123.47,110,98,87.31,82.41,73.42,65.41,61.74,55,49,43.65,41.2,36.71,32.7,30.87],b=document.getElementById("audio_space"),_.isObject(b)&&(a=new PhoneoPhone.AudioSpace(b,c))}.call(this);